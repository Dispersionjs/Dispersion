<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Dispersion</title>
	<!--Import Google Icon Font-->
	<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!--Import materialize.css-->
	<link type="text/css" rel="stylesheet" href="./bower_components/materialize/dist/css/materialize.min.css" media="screen,projection"
	/>
	<link rel="stylesheet" href="assets/css/style.css" media="screen" title="no title">
</head>

<body ng-app='myApp'>

	<div id='dash-content'>
		<div ng-controller='MainController as mainCtrl'>
			<daemon-load></daemon-load>
			<div ng-show=" mainCtrl.view !=='project' " class="row ">
				<div class="navbar-fixed ">
					<nav>
						<div class="nav-wrapper blue-grey darken-2 ">
							<a src="./assets/images/pedal.png " class="brand-logo left ">
								<img src="./assets/images/pedal.png " alt="some_text " style="width:25px;height:25px; ">Dispersion
							</a>
							<ul id="nav-mobile " class="right ">
								<li class='active fileNav'><a ng-click="mainCtrl.view='files' " href="# ">My Files</a></li>
								<li class='pubNav'><a ng-click="mainCtrl.view='publish'" href="# ">Publish</a></li>
								<li class='pubNav'><a class="modal-trigger " href="#modal1 "><i class="large material-icons ">settings</i></a></li>
							</ul>
						</div>
					</nav>
				</div>
			</div>

			<div ng-controller='FilesController as fileCtrl'>
				<div ng-show="mainCtrl.view==='files' ">

					<div class='row'>
						<div class="col s4 right ">
							<a class="waves-effect right amber darken-1 waves-light btn-large
		" ng-click='fileCtrl.addHash()'><label ><i class="material-icons right ">cloud</i></label>Add to IPFS</a>
						</div>

						<div class="col s4 left ">
							<select ng-model="sortBy ">
							    <option value=" " disabled selected>Filter Files</option>
           				<option value="time ">Date</option>
            			<option value="item ">Item</option>
            			<option value="fileType ">FileType</option>
        		</select>
						</div>
					</div>

					<div class="row ">
						<ul class="collapsible col s12 " data-collapsible="accordion ">
							<!--LI HEADER CONTENT-->
							<li class="collection-item grey lighten-2 avatar " ng-repeat='fileObj in fileCtrl.getFileData() | orderBy: sortBy track by $index '>
								<div class="collapsible-header ">
									<!--Set Icon-->
									<i ng-if="fileObj.fileType==='folder' " class="material-icons circle ">folder</i>
									<i ng-if="fileObj.fileType==='other' " class="material-icons circle ">web</i>
									<i ng-if="fileObj.fileType==='image' " class="material-icons circle ">visibility</i>
									<i ng-if="fileObj.fileType==='doc' " class="material-icons circle ">description</i>
									<i ng-if="fileObj.fileType==='excel' " class="material-icons circle green ">insert_chart</i>
									<i ng-if="fileObj.fileType==='video' " class="material-icons circle red ">play_arrow</i>
									<!--Header Li TEXT-->
									<span class="title text-darken-3 " ng-bind="fileObj.file"></span>
									<span class="right ">
										<span class="left " ng-bind="fileObj.date "></span>
									<!--<i class="material-icons ">info_outline</i>-->
									</span>
								</div>
								<!--LI BODY CONTENT-->
								<div class="collapsible-body ">
									<!--<p></p>-->
									<div class="row ">
										<div class="col s10 ">
											<h6><a href="{{fileObj.url}} ">{{fileObj.url}}</a></h6>
											<ul>
												<li ng-repeat="fileName in fileObj.files  track by $index">{{fileName}}</li>
											</ul>
											<a class="waves-effect amber darken-1 waves-light btn
		" ng-click='fileCtrl.addToPublish(fileObj)'><label ><i class="material-icons right ">send</i></label>Stage</a>
											<a class="waves-effect amber darken-1 waves-light btn
		" ng-click='fileCtrl.saveToDisk(fileObj.hash,fileCtrl.username)'><label ><i class="material-icons right ">send</i></label>Download</a>
											<a class="waves-effect amber darken-1 waves-light btn
		" ng-click='fileCtrl.deleteHash(fileObj.hash)'><label ><i class="material-icons right ">delete</i></label>Delete</a>
										</div>
									</div>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<div ng-controller='PublishController as pubCtrl' ng-show="mainCtrl.view==='publish' ">
				<div class=" row ">
					<div class="col s12 ">
						<publish-card></publish-card>
					</div>
				</div>
			</div>
			<div class="row projectView " ng-show="mainCtrl.view==='project' " style="position: absolute; width:100%; height:100% ">
				<div class="navbar-fixed ">
					<nav>
						<div class="nav-wrapper amber darken-2 ">
							<a src="./assets/images/pedal.png " class="brand-logo left ">
								<img src="./assets/images/pedal.png " alt="some_text " style="width:25px;height:25px; ">Dispersion
							</a>
							<ul id="nav-mobile " class="right ">
								<li class='active fileNav'><a ng-click="mainCtrl.view='files' " href="# ">My Files</a></li>
								<li class='pubNav'><a ng-click="mainCtrl.view='publish'" href="# ">Publish</a></li>
								<li class='pubNav'><a class="modal-trigger " href="#modal1 "><i class="large material-icons ">settings</i></a></li>
							</ul>
						</div>
					</nav>
				</div>

				<div class="project" ng-controller="ProjectController as projCtrl ">
					<h1 ng-bind="projCtrl.currentProject()" class="amber"></h1>
					<div>
						<ul>
							<!--{{projCtrl.publishedVersions()}}-->
							<li ng-repeat="version in projCtrl.publishedVersions() | orderBy: '-date' track by $index ">
								<button class="waves-effect blue-grey waves-light btn" ng-class="$index=== projCtrl.lastProjectIndex && projCtrl.showIframe ? 'selected': 'notSelected';
		" ng-click='projCtrl.selectVersion($index); projCtrl.toggleShowFiles($index)'>{{version.date |date:"MM/dd/yyyy 'at' h:mma "}}</button>
							</li>
						</ul>
						<div>
							<div ng-if="true">
								<!--{{projCtrl.filesList()}}-->
								<ul>
									<li ng-repeat="file in projCtrl.filesList() track by $index ">
										<div>
											<!--{{file}} {{projCtrl.filesList()}}

											<hr>
											<hr> {{$index}}
											<hr>
											<hr> {{projCtrl.currentProject()}}
											<hr>
											<hr> {{projCtrl.selectedVersion()}}
											<hr>
											<hr> {{projCtrl.publishedVersions()}}
											<hr>
											<hr> {{projCtrl.getMode(file)}} {{projCtrl.isImage(file)}}-->
											<file-history data-filename="{{file}}" data-index="{{$index}}" data-projectname="{{projCtrl.currentProject()}}" data-projectobject="{{projCtrl.selectedVersion()}}"
												data-mode="{{projCtrl.getMode(file)}}" data-image="{{projCtrl.isImage(file)}}"></file-history>
										</div>
									</li>
								</ul>
								<button ng-click="projCtrl.togglePreview() ">Preview</button>
								<iframe class="pagePreview " ng-show="projCtrl.preview " ng-src='{{projCtrl.currentUrl()}}'></iframe>
							</div>
						</div>
					</div>
				</div>
				<div ng-controller='SettingsController as settingsCtrl'>
					<!-- Settings Modal Structure -->
					<settings></settings>
				</div>
			</div>
		</div>
</body>


<script>
    // require other files to run in this process
    window.$ = window.jQuery = require('./bower_components/jquery/dist/jquery.min.js');
    window.Hammer = require('./bower_components/hammerjs/hammer.min.js');
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js "></script>
<!--<script src="./assets/js/dispersion.js "></script>-->
<script type="text/javascript " src="./bower_components/angular/angular.min.js "></script>
<script type="text/javascript " src="./components/directives/project-directive.js "></script>
<script type="text/javascript " src="./components/factories/fileFactory.js "></script>
<script type="text/javascript " src="./components/factories/ipfsService.js "></script>
<script type="text/javascript " src="./components/factories/publishService.js "></script>
<script type="text/javascript " src="./components/factories/diskFactory.js "></script>
<script type="text/javascript " src="./components/directives/daemon-load-directive.js "></script>
<script type="text/javascript " src="./components/directives/topbarDirective.js "></script>
<script type="text/javascript " src="./components/directives/publishDirective.js "></script>
<script type="text/javascript " src="./components/directives/settings-directive.js "></script>
<script type="text/javascript " src="./components/controllers/mainController.js "></script>
<script type="text/javascript " src="./components/controllers/FilesController.js "></script>
<script type="text/javascript " src="./components/controllers/publishController.js "></script>
<script type="text/javascript " src="./components/controllers/settingsController.js "></script>

<script type="text/javascript " src="./bower_components/ace-builds/src-min-noconflict/ace.js "></script>
<script type="text/javascript " src="./bower_components/angular-ui-ace/ui-ace.js "></script>
<script type="text/javascript " src="./bower_components/ace-builds/src-min-noconflict/ext-language_tools.js "></script>
<script type="text/javascript " src="./components/factories/ProjectService.js "></script>
<script type="text/javascript " src="./components/factories/FileHistoryFactory.js "></script>
<script type="text/javascript " src="./components/directives/FileHistoryDirective.js "></script>
<script type="text/javascript " src="./components/controllers/FileHistoryController.js "></script>
<script type="text/javascript " src="./components/controllers/ProjectController.js "></script>
<script>
    $(document).ready(function() {
        $('.pubNav').click(function(){
            $(this).addClass('active');
            $('.fileNav').removeClass('active');
        })

         $('.fileNav').click(function(){
            $(this).addClass('active');
            $('.pubNav').removeClass('active');
        })
        // the "href " attribute of .modal-trigger must specify the modal ID that wants to be triggered
         $('.modal-trigger').leanModal();

				 $('.collapsible').collapsible({ accordion : false });
				 // A setting that changes the collapsible behavior to expandable instead of the default accordion style 

        $('select').material_select();
    });
</script>
<script src="app.js "></script>

</html>